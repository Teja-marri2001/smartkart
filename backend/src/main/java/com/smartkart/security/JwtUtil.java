package com.smartkart.security; import io.jsonwebtoken.*; import io.jsonwebtoken.security.Keys; import org.springframework.stereotype.Component; import java.security.Key; import java.util.Date; import java.util.Map; @Component public class JwtUtil { private final Key key = Keys.hmacShaKeyFor("super-secret-key-change-me-please-32-characters".getBytes()); private final long expirationMs = 1000L*60*60*24; public String generateToken(String subject, Map<String,Object> claims){ return Jwts.builder().setClaims(claims).setSubject(subject).setIssuedAt(new Date()).setExpiration(new Date(System.currentTimeMillis()+expirationMs)).signWith(key, SignatureAlgorithm.HS256).compact(); } public Jws<Claims> parseToken(String token){ return Jwts.parserBuilder().setSigningKey(key).build().parseClaimsJws(token); } }